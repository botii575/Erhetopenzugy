
<!DOCTYPE html>

<html lang="hu">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>T≈ëketartoz√°s Kalkul√°tor | √ârthet≈ë P√©nz√ºgy</title>
<meta content="Sz√°molja ki fenn√°ll√≥ t≈ëketartoz√°s√°t a T≈ëketartoz√°s Kalkul√°tor seg√≠ts√©g√©vel. Egyszer≈±, gyors √©s √©rthet≈ë eszk√∂z az √ârthet≈ë P√©nz√ºgy csapat√°t√≥l." name="description"/>
<meta content="t≈ëketartoz√°s, hitelkalkul√°tor, t√∂rleszt≈ër√©szlet, hitel visszafizet√©s, kalkul√°tor" name="keywords"/>
<meta content="index, follow" name="robots"/>
<meta content="√ârthet≈ë P√©nz√ºgy" name="author"/>
<link href="https://www.erthetopenzugy.hu/kalkulator.html" rel="canonical"/>
<meta content="T≈ëketartoz√°s Kalkul√°tor | √ârthet≈ë P√©nz√ºgy" property="og:title">
<meta content="Sz√°molja ki fenn√°ll√≥ t≈ëketartoz√°s√°t online! Egyszer≈± √©s pontos kalkul√°tor az √ârthet≈ë P√©nz√ºgy weboldal√°n." property="og:description">
<meta content="https://www.erthetopenzugy.hu/kalkulator.html" property="og:url">
<meta content="website" property="og:type">
<meta content="https://www.erthetopenzugy.hu/logo.webp" property="og:image"/>
<script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "Organization",
    "name": "√ârthet≈ë P√©nz√ºgy",
    "url": "https://www.erthetopenzugy.hu",
    "logo": "https://www.erthetopenzugy.hu/images/favicon.png",
    "description": "Szem√©lyre szabott p√©nz√ºgyi tan√°csad√°s: biztos√≠t√°s, hitel, befektet√©s, nyugd√≠j, gyermek megtakar√≠t√°s, kgfb, casco, ad√≥kedvezm√©nyek.",
    "sameAs": [
      "https://www.facebook.com/profile.php?id=61569678660948",
      "https://www.instagram.com/ertheto_penzugy"
    ],
    "contactPoint": {
      "@type": "ContactPoint",
      "telephone": "+36 20 296 7292",
      "contactType": "customer service",
      "areaServed": "HU",
      "availableLanguage": "Hungarian"
    },
    "address": {
      "@type": "PostalAddress",
      "streetAddress": "V√∂r√∂smarty t√©r 4",
      "addressLocality": "Veszpr√©m",
      "postalCode": "8200",
      "addressCountry": "HU"
    }
  }
  </script>
<style>
    /* Sz√≠nek igaz√≠t√°sa a glob√°lis t√©ma v√°ltoz√≥khoz. */
    :root {
      --blue: var(--accent-color);
      --red: #cc0000;
      --bg: var(--bg-color);
      --ink: var(--text-color);
    }
    body {
      font-family: 'Poppins', system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      background-color: var(--bg-color);
      color: var(--text-color);
      margin: 0;
    }
    main.container{max-width:1050px;margin:32px auto;padding:0 16px}
    h2{margin:0 0 10px}
    .info-card{background:#fff3cd;border:1px solid #ffe08a;border-radius:12px;padding:12px;margin-bottom:16px}
    .contact-form{background:#fff;border-radius:14px;padding:16px;box-shadow:0 6px 18px rgba(0,0,0,.05)}
    label{display:block;font-weight:600;margin-top:10px}
    input[type="text"],input[type="number"],input[type="date"]{width:100%;padding:10px 12px;border:1px solid #d9dee3;border-radius:10px;font:inherit}
    button{cursor:pointer}
    button.primary{background:var(--blue);color:#fff;border:none;border-radius:12px;padding:12px 16px;font-weight:700;margin-top:12px}
    #output{background:#fff;border-radius:14px;padding:16px;box-shadow:0 6px 18px rgba(0,0,0,.05);margin-top:16px}
    .kpi{display:grid;grid-template-columns:repeat(4,minmax(0,1fr));gap:12px;margin-top:16px}
    .kpi .item{background:#fff;border-radius:14px;padding:14px;text-align:center;box-shadow:0 4px 14px rgba(0,0,0,.04)}
    .kpi .val{font-size:1.2rem;font-weight:700}
    .row{display:flex;gap:10px;flex-wrap:wrap;align-items:center}
    .tooltip{display:inline-block;width:18px;height:18px;border-radius:50%;background:#eef2f7;color:#334;line-height:18px;text-align:center;font-size:12px;margin-left:6px}
    .muted{color:#65727d;font-size:.9rem}
    .warn{background:#fff;border-left:4px solid #ff6f00;border-radius:10px;padding:10px;margin-top:10px}
    .grid{display:grid;grid-template-columns:repeat(12,1fr);gap:16px;margin-top:16px}
    .card{background:#fff;border-radius:14px;padding:16px;box-shadow:0 6px 18px rgba(0,0,0,.06)}
    @media(max-width:900px){ .kpi{grid-template-columns:repeat(2,1fr)} .grid{grid-template-columns:1fr} }
  
    /* ==== Layout fine-tuning for inputs & cards ==== */
    #kalkulator .card, 
    #kalkulator .contact-form {
      overflow: hidden; /* clip rounded corners */
    }
    #kalkulator input, 
    #kalkulator select, 
    #kalkulator textarea {
      box-sizing: border-box; /* avoid right-edge overflow */
      max-width: 100%;
      background-clip: padding-box;
    }
    
    /* ==== UI / spacing refinements ==== */
    #kalkulator h3 { margin: 0 0 8px; }
    #kalkulator .card { padding: 14px; }
    #kalkulator canvas { display:block; width:100% !important; height:260px !important; margin: 6px 0 6px; }
    #kalkulator #firstYearNote { margin-top: 8px; }
    #kalkulator #output { margin-top: 16px; }
    #kalkulator #amortizationTable { margin-top: 16px; }
    /* KPI highlights */
    #kalkulator .kpi .item.special {
      border: 1px solid #dbeafe;
      background: linear-gradient(180deg, #f0f7ff, #ffffff);
    }
    #kalkulator .kpi .item.special .val { color: #0b5394; }
    /* Responsive tuning */
    @media (max-width: 900px){
      #kalkulator .card { padding: 12px; }
      #kalkulator canvas { height: 240px !important; }
      #kalkulator .kpi .val { font-size: 1.1rem; }
    }
    @media (max-width: 900px){ #kalkulator .kpi { grid-template-columns: repeat(2, minmax(0,1fr)); } }
    @media (max-width: 600px){
      #kalkulator .card { padding: 10px; }
      #kalkulator h3 { font-size: 1rem; }
      #kalkulator canvas { height: 220px !important; }
      #kalkulator .kpi { grid-template-columns: 1fr; }
      #kalkulator .kpi .val { font-size: 1.05rem; }
    }
    
    /* ==== KPI auto-fit for large amounts ==== */
    #kalkulator .kpi { gap: 14px; grid-template-columns: repeat(3, minmax(0,1fr)); margin-bottom:14px; }
    #kalkulator .kpi .item {
      min-height: 92px;
      display: flex;
      flex-direction: column;
      justify-content: center;
      padding: 12px;
    }
    /* Provide a reasonable max font for desktop; JS will downsize if needed */
    #kalkulator .kpi .val {
      --kpi-max: 1.6;  /* rem */
      font-size: calc(var(--kpi-max) * 1rem);
      font-weight: 700;
      line-height: 1.15;
      white-space: normal;     /* wrapping allowed as last resort */
      word-break: keep-all;    /* ne t√∂rdelje a sz√°mot karakterenk√©nt */
    }
    @media (max-width: 900px){
      #kalkulator .kpi .val { --kpi-max: 1.4; }
    }
    @media (max-width: 900px){ #kalkulator .kpi { grid-template-columns: repeat(2, minmax(0,1fr)); } }
    @media (max-width: 600px){
      #kalkulator .kpi .item { min-height: 84px; }
      #kalkulator .kpi .val { --kpi-max: 1.2; }
    }
  
/* === Amortiz√°ci√≥s t√°bl√°zat ‚Äì egys√©ges, olvashat√≥ form√°z√°s === */
#amortizationTable table {
  width: 100%;
  border-collapse: collapse;
  font-size: 0.95rem;
  table-layout: fixed;
}

#amortizationTable th, 
#amortizationTable td {
  border: 1px solid #d9dee3;
  padding: 8px 10px;
  text-align: right;
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
}

#amortizationTable th {
  background: #f0f4f8;
  font-weight: 600;
  text-align: center;
  position: sticky;
  top: 0;
  z-index: 1;
}

#amortizationTable tbody tr:nth-child(even) { background: #fafafa; }
#amortizationTable tbody tr:hover { background: #f5faff; }

/* H√≥nap + D√°tum k√∂z√©pre, a t√∂bbi jobbra */
#amortizationTable td:nth-child(1),
#amortizationTable td:nth-child(2) {
  text-align: center;
}

/* Kisebb kijelz≈ën kisebb bet≈± */
@media (max-width: 600px){
  #amortizationTable table { font-size: 0.9rem; }
}

</style>
<link href="styles.css" rel="stylesheet"/>
<!-- S√∂t√©t t√©ma fel√ºl√≠r√°sai a kalkul√°torhoz (a glob√°lis st√≠lus ut√°n, hogy fel√ºl√≠rja azokat) -->
<style>
    /* Kalkul√°tor: k√°rty√°k, inputok √©s sz√∂vegek s√∂t√©t t√©m√°ban */
    body.dark-mode #kalkulator input[type="text"],
    body.dark-mode #kalkulator input[type="number"],
    body.dark-mode #kalkulator input[type="date"],
    body.dark-mode #kalkulator select,
    body.dark-mode #kalkulator textarea {
      background-color: var(--card-bg);
      color: var(--text-color);
      border-color: var(--accent-color);
    }

    body.dark-mode #kalkulator .card,
    body.dark-mode #kalkulator .contact-form,
    body.dark-mode #kalkulator #output,
    body.dark-mode #kalkulator .kpi .item {
      background-color: var(--card-bg);
      color: var(--text-color);
    }

    /* Kiemelt KPI k√°rty√°k */
    body.dark-mode #kalkulator .kpi .item.special {
      background: linear-gradient(180deg, rgba(255,255,255,0.05), rgba(255,255,255,0.02));
      border: 1px solid var(--accent-color);
    }
    body.dark-mode #kalkulator .kpi .item.special .val {
      color: var(--accent-color);
    }

    /* KPI √©rt√©kek √©s feliratok */
    body.dark-mode #kalkulator .kpi .val {
      color: var(--accent-color) !important;
      opacity: 1;
    }
    body.dark-mode #kalkulator .muted {
      color: var(--text-color);
      opacity: 0.8;
    }

    /* Figyelmeztet≈ë doboz */
    body.dark-mode #kalkulator .warn {
      background-color: var(--card-bg);
      color: var(--text-color);
      border-left-color: var(--accent-color);
    }

    /* Tooltip sz√≠nek */
    body.dark-mode #kalkulator .tooltip {
      background-color: var(--accent-color);
      color: var(--bg-color);
    }

    /* Amortiz√°ci√≥s t√°bla s√∂t√©t m√≥d: sz√≠nek √©s kontraszt */
    /* Amortiz√°ci√≥s t√°bl√°zat: nagyobb kontraszt a s√∂t√©t t√©m√°ban */
    body.dark-mode #kalkulator #amortizationTable table {
      /* a teljes t√°bl√°zat vil√°gos sz√≠nek k√∂z√∂tt jelenjen meg */
      border-color: var(--accent-color) !important;
      color: var(--text-color) !important;
      opacity: 1 !important;
    }

    /* A t√°bla k√ºls≈ë kont√©nere is legyen vil√°gosabb, hogy a sorok j√≥l l√°tsz√≥djanak */
    body.dark-mode #kalkulator #amortizationTable {
      background-color: var(--card-bg) !important;
      color: var(--text-color) !important;
    }

    /*
     * Amortiz√°ci√≥s t√°bl√°zat egyedi oszt√°llyal ('am-table'): ezzel biztos√≠tjuk,
     * hogy a s√∂t√©t t√©m√°ban a cell√°k √©s sorok kontrasztosak legyenek. A
     * JavaScript k√≥d a t√°bl√°zatot ezzel az oszt√°llyal hozza l√©tre.
     */
    body.dark-mode #kalkulator .am-table th,
    body.dark-mode #kalkulator .am-table td {
      color: var(--text-color) !important;
      border-color: var(--accent-color) !important;
    }
    body.dark-mode #kalkulator .am-table tr:nth-child(odd) {
      background-color: rgba(255, 255, 255, 0.12) !important;
    }
    body.dark-mode #kalkulator .am-table tr:nth-child(even) {
      background-color: rgba(255, 255, 255, 0.18) !important;
    }
    body.dark-mode #kalkulator .am-table tr:hover {
      background-color: rgba(255, 255, 255, 0.25) !important;
    }
    body.dark-mode #kalkulator #amortizationTable th,
    body.dark-mode #kalkulator #amortizationTable td {
      /* cell√°k √©s fejl√©cek sz√∂vege legyen teljesen vil√°gos */
      color: var(--text-color) !important;
      border-color: var(--accent-color) !important;
      opacity: 1 !important;
    }
    body.dark-mode #kalkulator #amortizationTable th {
      /* fejl√©c h√°tt√©r legyen kiss√© s√∂t√©tebb a k√°rty√°n√°l */
      background-color: rgba(255, 255, 255, 0.08) !important;
    }
    body.dark-mode #kalkulator #amortizationTable tbody tr:nth-child(odd) {
      /* a p√°ratlan sorok legyenek jobban kiemelve ‚Äì √°ttetsz≈ë vil√°gos h√°tterek */
      background-color: rgba(255, 255, 255, 0.12) !important;
    }
    body.dark-mode #kalkulator #amortizationTable tbody tr:nth-child(even) {
      background-color: rgba(255, 255, 255, 0.18) !important;
    }
    body.dark-mode #kalkulator #amortizationTable tbody tr:hover {
      /* hover eset√©n m√©g vil√°gosabb √°rnyalat */
      background-color: rgba(255, 255, 255, 0.25) !important;
    }
  </style>
<!-- Cookie banner st√≠lusok -->
<link href="cookies.css" rel="stylesheet"/>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&amp;display=swap" rel="stylesheet"/>
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet"/>
</meta></meta></meta></meta></head>
<body>
<!-- Oldal fejl√©ce a f≈ëoldalr√≥l √°temelve -->
<header>
<picture>
<source media="(max-width: 600px)" srcset="images/header_background-400.webp"/>
<source media="(max-width: 1024px)" srcset="images/header_background-800.webp"/>
<!-- Descriptive alt text and lazy loading for the calculator hero image -->
<img alt="Kalkul√°tor fejl√©c h√°tt√©r" loading="lazy" src="images/header_background-1200.webp"/>
</picture>
<div class="header-overlay"></div>
<div class="site-title">√ârthet≈ë P√©nz√ºgy</div>
<button class="hamburger" onclick="toggleMobileMenu()">‚ò∞</button>
</header>
<!-- Navig√°ci√≥s men√º: ugyanaz a strukt√∫ra, mint a f≈ëoldalon, de relat√≠v linkekkel -->
<nav class="compact-nav" id="mobileNav">
<ul>
<li><a href="index.html#start" onclick="toggleMobileMenu()">Bemutatkoz√°s</a></li>
<li><a href="index.html#szolgaltatasok" onclick="toggleMobileMenu()">Szolg√°ltat√°sok</a></li>
<li><a href="index.html#tanacsadoink" onclick="toggleMobileMenu()">Tan√°csad√≥ink</a></li>
<li><a href="index.html#rolunk" onclick="toggleMobileMenu()">R√≥lunk √≠rt√°k</a></li>
<li><a href="index.html#kapcsolat" onclick="toggleMobileMenu()">Kapcsolat</a></li>
<li><a href="index.html#karrier" onclick="toggleMobileMenu()">Karrier</a></li>
<li><a href="kalkulator.html" onclick="toggleMobileMenu()">Kalkul√°tor</a></li>
<li><a href="blog.html" onclick="toggleMobileMenu()">Blog</a></li>
</ul>
</nav>
<main class="container" id="kalkulator">
<h1>T≈ëketartoz√°s kalkul√°tor (Annuit√°s)</h1>
<div class="info-card">
<strong>Fontos!</strong> A kalkul√°ci√≥ eredm√©nye <strong>t√°j√©koztat√≥ jelleg≈±</strong>, nem min≈ës√ºl hitelaj√°nlatnak vagy hivatalos igazol√°snak.
    </div>
<div class="grid">
<section class="card" style="grid-column: span 6">
<h3>Alap adatok</h3>
<label>Hitel kezdete <span class="tooltip" title="Az els≈ë t√∂rleszt≈ër√©szlet napja.">i</span></label>
<input id="startDate" type="date"/>
<label>Hitel√∂sszeg </label>
<input id="amount" placeholder="Pl. 10 000 000" type="text"/>
<label>Kamat (% / √©v) <span class="tooltip" title="Nomin√°lis √©ves kamat. A cs√∫szk√°val is √°ll√≠that√≥.">i</span></label>
<div class="row">
<input id="rate" placeholder="Pl. 6" step="0.01" style="max-width:140px" type="number"/>
<input id="rateSlider" max="25" min="0.5" step="0.05" style="flex:1" type="range" value="6"/>
<span class="muted" id="rateLabel">6,00%</span>
</div>
<label>Futamid≈ë (√©v)</label>
<input id="term" placeholder="Pl. 20" type="number">
<button class="primary" id="calcBtn">Sz√°mol√°s</button>
<div id="warnings"></div>
</input></section>
<section class="card" style="grid-column: span 6">
<h3>√Åttekint√©s</h3>
<div class="kpi">
<div class="item"><div class="muted">Havi t√∂rleszt≈ë</div><div class="val" id="kpiPayment">‚Äì</div></div>
<div class="item"><div class="muted">Teljes kamat</div><div class="val" id="kpiTotalInterest">‚Äì</div></div>
<div class="item"><div class="muted">Jelenlegi t≈ëketartoz√°s</div><div class="val" id="kpiOutstanding">‚Äì</div></div>
</div>
<div class="kpi" style="grid-template-columns: repeat(2, minmax(0,1fr));">
<div class="item special"><div class="muted">Teljes visszafizet√©s</div><div class="val" id="kpiTotalPaid">‚Äì</div></div>
<div class="item special"><div class="muted">Fordul√≥pont</div><div class="val" id="kpiSwitch">‚Äì</div></div>
</div>
</section>
</div>
<div class="grid">
<section class="card" style="grid-column: span 7">
<h3>Kamat vs. T≈ëke ar√°ny id≈ëben</h3>
<canvas id="loanChart" style="max-width:100%; margin-top:10px;"></canvas>
</section>
<section class="card" style="grid-column: span 5">
<h3>1. √©v bont√°sa</h3>
<canvas height="180" id="year1Chart"></canvas>
<div class="muted" id="firstYearNote" style="margin-top:8px"></div>
</section>
</div>
<div class="result card" id="output" style="display:none"></div>
<section class="card" style="margin-top: 24px;">
<h3>Kamat√©rz√©kenys√©gi szimul√°ci√≥</h3>
<p class="muted">Pr√≥b√°ld ki, hogyan v√°ltozik a havi t√∂rleszt≈ë √©s teljes visszafizet√©s elt√©r≈ë kamatszintekn√©l!</p>
<div class="contact-form" style="margin-top: 12px;">
<div class="row" style="align-items:center;gap:10px">
<label style="margin:0">¬± elt√©r√©s (%)</label>
<input id="deltaInput" max="10" min="0" step="0.1" style="max-width:90px" type="number" value="1.0"/>
<input id="deltaSlider" max="10" min="0" step="0.1" style="flex:1" type="range" value="1.0"/>
</div>
<div class="muted" id="scenarioHint" style="margin-top:8px; display:none"></div>
<div id="scenarioResults" style="margin-top: 8px; display: grid; gap: 6px;"></div>
</div>
</section>
<section class="card" style="margin-top: 16px;">
<h3>Eredm√©nyek let√∂lt√©se</h3>
<p class="muted">T√∂ltse le a teljes t√°bl√°zatot PDF form√°tumban.</p>
<button class="primary" id="downloadPDF" style="display:none;">üìÑ PDF ment√©s</button>
</section>
<div class="card" id="amortizationTable" style="overflow-x:auto; margin-top:16px;"></div>
</main>
<!-- L√°bjegyzet √©s jogi inform√°ci√≥k -->
<footer>
<div class="social-icons">
<a href="https://www.facebook.com/profile.php?id=61569678660948"><i class="fab fa-facebook"></i></a>
<a href="https://www.instagram.com/ertheto_penzugy"><i class="fab fa-instagram"></i></a>
</div>
<p>¬© 2024 √ârthet≈ë P√©nz√ºgy. Minden jog fenntartva.</p>
<p>E‚Äëmail: kapcsolat@erthetopenzugy.hu | Tel: 06202967292</p>
<p>C√≠m: 8200, Veszpr√©m, V√∂r√∂smarty t√©r¬†4</p>
<div class="legal-links">
<a href="#" onclick="showContent('adatkezeles');return false;">Adatkezel√©si t√°j√©koztat√≥</a> |
      <a href="#" onclick="showContent('impresszum');return false;">Impresszum</a>
</div>
</footer>
<div class="scroll-top">
<i class="fas fa-chevron-up"></i>
</div>
<!-- Adatv√©delmi t√°j√©koztat√≥ modal (teljes v√°ltozat) -->
<!-- Teljes Adatkezel√©si t√°j√©koztat√≥ modal a kalkul√°torhoz -->
<div class="modal" id="adatkezeles">
<div class="modal-content">
<span class="close" onclick="hideContent('adatkezeles')">√ó</span>
<h2>Adatkezel√©si t√°j√©koztat√≥</h2>
<div class="accordion">
<div class="accordion-item" id="adatkezelo">
<h3 class="accordion-header">1. Az adatkezel≈ë adatai</h3>
<div class="accordion-content">
<div class="info-card">
<p><i class="fas fa-building"></i> <strong>N√©v:</strong> Horv√°th Gonna Solve It Korl√°tolt Felel≈ëss√©g≈± T√°rsas√°g</p>
<p><i class="fas fa-map-marker-alt"></i> <strong>Sz√©khely:</strong> 8230 Balatonf√ºred, Kr√∫dy Gyula sor 4/B.</p>
<p><i class="fas fa-file-alt"></i> <strong>C√©gjegyz√©ksz√°m:</strong> 19-09-523953</p>
<p><i class="fas fa-id-card"></i> <strong>Ad√≥sz√°m:</strong> 32330430-1-19</p>
<p><i class="fas fa-envelope"></i> <strong>E-mail:</strong> kapcsolat@erthetopenzugy.hu</p>
<p><i class="fas fa-phone"></i> <strong>Telefon:</strong> +36 20 296 7292</p>
</div>
</div>
</div>
<div class="accordion-item" id="kezelt-adatok">
<h3 class="accordion-header">2. A kezelt szem√©lyes adatok k√∂re</h3>
<div class="accordion-content">
<p>Weboldalunk l√°togat√°sa sor√°n a k√∂vetkez≈ë szem√©lyes adatokat kezelj√ºk:</p>
<ul>
<li>IP c√≠m</li>
<li>A l√°togat√°s id≈ëpontja</li>
<li>A megtekintett oldalak adatai</li>
<li>Az √ñn √°ltal haszn√°lt b√∂ng√©sz≈ë √©s oper√°ci√≥s rendszer t√≠pusa</li>
</ul>
<p>Ingyenes tan√°csad√°sra val√≥ jelentkez√©s eset√©n az al√°bbi adatokat gy≈±jtj√ºk:</p>
<ul>
<li>N√©v</li>
<li>E-mail c√≠m</li>
<li>Telefonsz√°m</li>
</ul>
</div>
</div>
<div class="accordion-item" id="cel-jogalap">
<h3 class="accordion-header">3. Az adatkezel√©s c√©lja √©s jogalapja</h3>
<div class="accordion-content">
<p>Adatkezel√©s√ºnk c√©lja:</p>
<ul>
<li>A weboldal megfelel≈ë m≈±k√∂d√©s√©nek biztos√≠t√°sa</li>
<li>A felhaszn√°l√≥i √©lm√©ny jav√≠t√°sa</li>
<li>Kapcsolattart√°s az √ºgyfelekkel</li>
<li>Szolg√°ltat√°saink fejleszt√©se</li>
<li>Ingyenes tan√°csad√°s biztos√≠t√°sa √©s id≈ëpontegyeztet√©s</li>
</ul>
<p>Az adatkezel√©s jogalapja:</p>
<ul>
<li>A weboldal m≈±k√∂d√©s√©hez sz√ºks√©ges adatok eset√©ben: jogos √©rdek (GDPR 6. cikk (1) bekezd√©s f) pont)</li>
<li>Az ingyenes tan√°csad√°sra val√≥ jelentkez√©s sor√°n megadott adatok eset√©ben: az √ñn √∂nk√©ntes hozz√°j√°rul√°sa (GDPR 6. cikk (1) bekezd√©s a) pont)</li>
</ul>
</div>
</div>
<div class="accordion-item" id="idotartam">
<h3 class="accordion-header">4. Az adatkezel√©s id≈ëtartama</h3>
<div class="accordion-content">
<ul>
<li>A l√°togat√°ssal kapcsolatos adatokat 30 napig ≈ërizz√ºk meg.</li>
<li>Az ingyenes tan√°csad√°sra val√≥ jelentkez√©s sor√°n megadott adatokat a tan√°csad√°s lebonyol√≠t√°s√°t k√∂vet≈ë 30 napig, vagy az √ñn hozz√°j√°rul√°s√°nak visszavon√°s√°ig t√°roljuk.</li>
<li>A kapcsolatfelv√©tel sor√°n megadott egy√©b adatokat az √ºgy lez√°r√°s√°t k√∂vet≈ë 1 √©vig t√°roljuk, kiv√©ve, ha jogszab√°ly hosszabb meg≈ërz√©si id≈ët √≠r el≈ë.</li>
</ul>
</div>
</div>
<div class="accordion-item" id="jogok">
<h3 class="accordion-header">5. Az √ñn jogai</h3>
<div class="accordion-content">
<p>√ñnnek joga van:</p>
<ul>
<li>T√°j√©koztat√°st k√©rni az adatkezel√©sr≈ël</li>
<li>Hozz√°f√©rni a kezelt adataihoz</li>
<li>K√©rni az adatok helyesb√≠t√©s√©t vagy t√∂rl√©s√©t</li>
<li>Tiltakozni az adatkezel√©s ellen</li>
<li>Adathordozhat√≥s√°ghoz val√≥ jog√°t gyakorolni</li>
<li>Visszavonni a hozz√°j√°rul√°s√°t az adatkezel√©shez</li>
</ul>
<p>Az adatai t√∂rl√©s√©t vagy a hozz√°j√°rul√°s visszavon√°s√°t a kapcsolat@erthetopenzugy.hu e-mail c√≠men k√©rheti.</p>
</div>
</div>
<div class="accordion-item" id="adatbiztonsag">
<div class="accordion-item" id="adattovabbitas">
<h3 class="accordion-header">7. Adattov√°bb√≠t√°s</h3>
<div class="accordion-content">
<p>Az √ñn √°ltal megadott szem√©lyes adatokat nem tov√°bb√≠tjuk harmadik f√©lnek, kiv√©ve:</p>
<ul>
<li>Jogszab√°lyi k√∂telezetts√©g eset√©n</li>
<li>
                  Google Analytics szolg√°ltat√°s haszn√°lata keret√©ben, melynek sor√°n az adatok az Egyes√ºlt √Ållamokba ker√ºlnek √°tvitelre. Az adattov√°bb√≠t√°s jogalapja az √ñn hozz√°j√°rul√°sa (GDPR 6. cikk (1) bekezd√©s a) pont), valamint a Google LLC r√©szv√©tele az EU‚ÄìUS Data Privacy Framework alapj√°n, amelyet az Eur√≥pai Bizotts√°g megfelel≈ës√©gi hat√°rozata elismer (GDPR 45. cikk).
                </li>
</ul>
<p>Harmadik orsz√°gba t√∂rt√©n≈ë adattov√°bb√≠t√°s eset√©n a GDPR 44-49. cikkeiben foglalt garanci√°kat alkalmazzuk.</p>
</div>
</div>
</div>
<div class="accordion-item" id="automatalt-dontes">
<h3 class="accordion-header">8. Automatiz√°lt d√∂nt√©shozatal</h3>
<div class="accordion-content">
<p>Weboldalunk nem alkalmaz automatiz√°lt d√∂nt√©shozatali folyamatokat, bele√©rtve a profilalkot√°st sem.</p>
</div>
</div>
<div class="accordion-item" id="sutik">
<h3 class="accordion-header">9. S√ºtik (cookie-k) kezel√©se</h3>
<div class="accordion-content">
<section class="cookie-policy">
<h3>Cookie Szab√°lyzat</h3>
<h4>Milyen s√ºtiket haszn√°lunk?</h4>
<div class="table-container">
<table>
<tr>
<th>Cookie t√≠pus</th>
<th>N√©v</th>
<th>C√©l</th>
<th>√âlettartam</th>
</tr>
<tr>
<td data-label="Cookie t√≠pus">Sz√ºks√©ges</td>
<td data-label="N√©v">session_cookie</td>
<td data-label="C√©l">Munkamenet nyilv√°ntart√°s</td>
<td data-label="√âlettartam">Munkamenet v√©g√©ig</td>
</tr>
<tr>
<td data-label="Cookie t√≠pus">Analitikai</td>
<td data-label="N√©v">_ga</td>
<td data-label="C√©l">L√°togat√≥k azonos√≠t√°sa (Google Analytics)</td>
<td data-label="√âlettartam">2 √©v</td>
</tr>
<tr>
<td data-label="Cookie t√≠pus">Analitikai</td>
<td data-label="N√©v">_gid</td>
<td data-label="C√©l">L√°togat√≥k megk√ºl√∂nb√∂ztet√©se (Google Analytics)</td>
<td data-label="√âlettartam">24 √≥ra</td>
</tr>
<tr>
<td data-label="Cookie t√≠pus">Analitikai</td>
<td data-label="N√©v">_gat</td>
<td data-label="C√©l">K√©r√©sek korl√°toz√°sa (Google Analytics)</td>
<td data-label="√âlettartam">1 perc</td>
</tr>
</table>
</div>
<div class="cookie-settings">
<h4>S√ºti be√°ll√≠t√°sok</h4>
<label>
<input checked="" disabled="" id="essential-cookies" type="checkbox">
                  Elengedhetetlen s√ºtik
                </input></label>
<label>
<input id="analytics-cookies" type="checkbox">
                  Analitikai s√ºtik
                </input></label>
<button class="button" onclick="saveCookieSettings()">Be√°ll√≠t√°sok ment√©se</button>
</div>
</section>
</div>
</div>
<div class="accordion-item" id="panasztetel">
<h3 class="accordion-header">10. Panaszt√©teli jog</h3>
<div class="accordion-content">
<p>√ñn jogosult panaszt tenni a fel√ºgyeleti hat√≥s√°gn√°l, ha √∫gy √©rzi, hogy szem√©lyes adatainak kezel√©se nem felel meg a jogszab√°lyi k√∂vetelm√©nyeknek. A fel√ºgyeleti hat√≥s√°g el√©rhet≈ës√©ge:</p>
<div class="info-card">
<p><strong>Nemzeti Adatv√©delmi √©s Inform√°ci√≥szabads√°g Hat√≥s√°g</strong></p>
<p><i class="fas fa-map-marker-alt"></i> C√≠m: 1055 Budapest, Falk Miksa utca 9-11.</p>
<p><i class="fas fa-envelope"></i> Postac√≠m: 1363 Budapest, Pf.: 9.</p>
<p><i class="fas fa-phone"></i> Telefon: +36 1 391 1400</p>
<p><i class="fas fa-envelope"></i> E-mail: ugyfelszolgalat@naih.hu</p>
<p><i class="fas fa-globe"></i> Weboldal: https://www.naih.hu/</p>
</div>
</div>
</div>
<div class="accordion-item" id="felulvizsgalat">
<h3 class="accordion-header">11. Az adatv√©delmi nyilatkozat fel√ºlvizsg√°lata</h3>
<div class="accordion-content">
<p>Jelen adatv√©delmi nyilatkozatot rendszeresen, de legal√°bb √©vente fel√ºlvizsg√°ljuk √©s sz√ºks√©g eset√©n friss√≠tj√ºk.</p>
</div>
</div>
<div class="accordion-item" id="kapcsolat">
<h3 class="accordion-header">12. Kapcsolat</h3>
<div class="accordion-content">
<p>Adatv√©delemmel kapcsolatos k√©rd√©seivel forduljon hozz√°nk bizalommal az al√°bbi el√©rhet≈ës√©geken:</p>
<div class="info-card">
<p><i class="fas fa-envelope"></i> E-mail: kapcsolat@erthetopenzugy.hu</p>
<p><i class="fas fa-phone"></i> Telefon: 06 20 296 7292</p>
</div>
</div>
</div>
<div class="accordion-item" id="kulso-szolgaltatok">
<h3 class="accordion-header">13. K√ºls≈ë szolg√°ltat√≥k ig√©nybev√©tele (Google Forms, Gmail)</h3>
<div class="accordion-content">
<p>
              A kapcsolatfelv√©teli ≈±rlap kit√∂lt√©se sor√°n megadott szem√©lyes adatokat a Google LLC (1600 Amphitheatre Parkway, Mountain View, CA 94043, USA) szolg√°ltat√°sai ‚Äì Google Forms, Google Sheets √©s Gmail ‚Äì dolgozz√°k fel technikai eszk√∂zeikkel.
            </p>
<p>
              Az ≈±rlap √©s annak v√°laszai a Google eur√≥pai adatk√∂zpontjaiban ker√ºlnek r√∂gz√≠t√©sre. Az automatikus √©rtes√≠t√©s a Gmail szolg√°ltat√°son kereszt√ºl ker√ºl tov√°bb√≠t√°sra az adatkezel≈ë emailc√≠m√©re (kapcsolat@erthetopenzugy.hu).
            </p>
<p>
              A Google LLC az Eur√≥pai Uni√≥ √©s az Egyes√ºlt √Ållamok k√∂z√∂tti Adatv√©delmi Keretrendszer (EU‚ÄìUS Data Privacy Framework) alapj√°n megfelel≈ës√©gi nyilatkozattal rendelkezik, √≠gy az adattov√°bb√≠t√°s jogalapja a GDPR 45. cikk szerinti megfelel≈ës√©gi hat√°rozat.
            </p>
<p>
              Nem t√∂rt√©nik automatiz√°lt d√∂nt√©shozatal vagy profilalkot√°s.
            </p>
</div>
</div>
<p class="last-updated">Utols√≥ friss√≠t√©s d√°tuma: 2025.04.30.</p>
</div>
</div>
</div>
<!-- Impresszum modal (r√∂vid√≠tett v√°ltozat) -->
<div class="modal" id="impresszum">
<div class="modal-content">
<span class="close" onclick="hideContent('impresszum')">√ó</span>
<h2>Impresszum</h2>
<div class="info-card">
<h3><i class="fas fa-info-circle"></i> Szolg√°ltat√≥ adatai</h3>
<p><strong>N√©v:</strong> Horv√°th¬†Gonna¬†Solve¬†It¬†Kft.</p>
<p><strong>Sz√©khely:</strong> 8230¬†Balatonf√ºred,¬†Kr√∫dy¬†Gyula¬†sor¬†4/B.</p>
<p><strong>C√©gjegyz√©ksz√°m:</strong> 19‚Äë09‚Äë523953</p>
<p><strong>Ad√≥sz√°m:</strong> 32330430‚Äë1‚Äë19</p>
<p><strong>E‚Äëmail:</strong> kapcsolat@erthetopenzugy.hu</p>
<p><strong>Telefon:</strong> +36¬†20¬†296¬†7292</p>
</div>
<div class="info-card">
<h3><i class="fas fa-server"></i> T√°rhelyszolg√°ltat√≥ adatai</h3>
<p><strong>N√©v:</strong> Sybell¬†Informatika¬†Kft.</p>
<p><strong>C√≠m:</strong> 1158¬†Budapest,¬†K√©sm√°rk¬†u.¬†7/B¬†2.¬†em.¬†206.</p>
<p><strong>Telefon:</strong> +36¬†1¬†707¬†67¬†27</p>
<p><strong>E‚Äëmail:</strong> info@sybell.hu</p>
<p><strong>Web:</strong> www.sybell.hu</p>
</div>
</div>
</div>
<!-- Cookie be√°ll√≠t√°si panel -->
<div class="cookie-widget" id="cookieWidget">
<div class="widget-header">
<h3>Cookie be√°ll√≠t√°sok</h3>
<button class="close-widget">√ó</button>
</div>
<div class="ai-recommendation">
      Ez a weboldal cookie‚Äëkat haszn√°l. K√©rlek, v√°laszd ki, milyen t√≠pus√∫ cookie‚Äëkat enged√©lyezel.
    </div>
<div class="category-toggle">
<div class="toggle-item">
<span>Analitikai cookie (Google¬†Analytics)</span>
<label class="switch">
<input id="analyticsToggle" type="checkbox">
<span class="slider"></span>
</input></label>
</div>
</div>
<div class="widget-actions">
<button class="accept-all">√ñsszes elfogad√°sa</button>
<button class="save-settings">Be√°ll√≠t√°sok ment√©se</button>
</div>
</div>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
  (function(){
    let amortizationRows = []; // PDF-hez
    let chartInstance = null;
    let year1Chart = null;

    // Grafikon adatok glob√°lis t√°rol√°sa. A s√∂t√©t/vil√°gos t√©ma v√°lt√°skor
    // ezek seg√≠ts√©g√©vel tudjuk √∫jra rajzolni a grafikonokat az √∫j sz√≠nek szerint.
    let chartLabels = [];
    let chartCapital = [];
    let chartInterest = [];
    let firstYearPrincipal = 0;
    let firstYearInterest = 0;

    const HUF = new Intl.NumberFormat('hu-HU');
    const parseHuf = v => parseFloat((v||'').toString().replace(/[^\d]/g,''))||0;
    const fmt = v => HUF.format(Math.round(v));
    const clamp = (x,min,max)=>Math.max(min,Math.min(max,x));

    // Seg√©df√ºggv√©ny: hex sz√≠nt √°talak√≠t rgba form√°tum√∫v√° megadott alfa √©rt√©kkel.
    function hexToRGBA(hex, alpha) {
      let h = (hex || '').toString().replace('#','');
      if (h.length === 3) {
        h = h.split('').map(c => c + c).join('');
      }
      const r = parseInt(h.substring(0,2), 16);
      const g = parseInt(h.substring(2,4), 16);
      const b = parseInt(h.substring(4,6), 16);
      return `rgba(${r},${g},${b},${alpha})`;
    }

    // A Chart.js sz√≠nek friss√≠t√©se aktu√°lis t√©masz√≠nek alapj√°n. Megh√≠vhat√≥ t√©ma-v√°lt√°s ut√°n.
    function updateChartColors(){
      try {
        const styles = getComputedStyle(document.documentElement);
        const textColor = styles.getPropertyValue('--text-color').trim() || '#003366';
        // Glob√°lis alap√©rtelmezett sz√≠n a Chart.js-hez (tengely, c√≠mke stb.)
        if (typeof Chart !== 'undefined' && Chart.defaults) {
          Chart.defaults.color = textColor;
        }
        // Ha m√°r l√©teznek grafikonok, friss√≠tj√ºk azok sz√≠neit √©s √∫jrarajzoljuk ≈ëket
        if (chartInstance) {
          if (chartInstance.options.scales) {
            if (chartInstance.options.scales.x && chartInstance.options.scales.x.ticks) {
              chartInstance.options.scales.x.ticks.color = textColor;
            }
            if (chartInstance.options.scales.y && chartInstance.options.scales.y.ticks) {
              chartInstance.options.scales.y.ticks.color = textColor;
            }
          }
          if (chartInstance.options.plugins && chartInstance.options.plugins.legend && chartInstance.options.plugins.legend.labels) {
            chartInstance.options.plugins.legend.labels.color = textColor;
          }
          chartInstance.update();
        }
        if (year1Chart) {
          if (year1Chart.options.plugins && year1Chart.options.plugins.legend && year1Chart.options.plugins.legend.labels) {
            year1Chart.options.plugins.legend.labels.color = textColor;
          }
          year1Chart.update();
        }
      } catch (e) {
        console && console.warn && console.warn('Chart sz√≠n friss√≠t√©si hiba:', e);
      }
    }

    function note(msg){
      const warningsBox = document.getElementById('warnings');
      const div = document.createElement('div');
      div.className = 'warn';
      div.textContent = msg;
      warningsBox.innerHTML = '';
      warningsBox.appendChild(div);
      setTimeout(()=>{ if(warningsBox.contains(div)) warningsBox.removeChild(div); }, 5000);
    }

    function safeStartDate(){
      const raw = document.getElementById('startDate').value;
      let dt = null;
      if(raw){
        const parts = raw.split('-');
        if(parts.length===3){
          const y=+parts[0], m=(+parts[1])-1, d=+parts[2];
          dt = new Date(y, m, d);
        }else{
          const t = Date.parse(raw);
          if(!Number.isNaN(t)) dt = new Date(t);
        }
      }
      if(!dt || Number.isNaN(dt.getTime())){
        const today = new Date();
        note('A kezd≈ëd√°tum hi√°nyzott vagy hib√°s volt, a mai nappal sz√°moltam.');
        return new Date(today.getFullYear(), today.getMonth(), today.getDate());
      }
      return dt;
    }

    // form√°z√°s az √∂sszegmez≈ën
    (function(){
      const el = document.getElementById('amount');
      el.addEventListener('input',()=>{
        const raw = el.value.replace(/[^\d]/g,'');
        el.value = raw ? HUF.format(raw) : '';
      });
    })();

    // kamat cs√∫szka / input szinkron
    const rateInput = document.getElementById('rate');
    const rateSlider = document.getElementById('rateSlider');
    const rateLabel = document.getElementById('rateLabel');
    function syncRate(val){ const v=+val; rateInput.value = v.toFixed(2); rateSlider.value = v; rateLabel.textContent = v.toFixed(2).replace('.',',')+'%'; }
    rateInput.addEventListener('input',()=>{ const v=parseFloat(rateInput.value)||0; syncRate(clamp(v,0.5,25)); compareScenarios(); });
    rateSlider.addEventListener('input',()=>{ syncRate(rateSlider.value); compareScenarios(); });
    syncRate(6);

function renderMainChart(labels, capital, interest){
      try{
        const ctx = document.getElementById("loanChart").getContext("2d");
        if (!ctx) return;
        // jelenlegi t√©ma szerinti sz√≠nek beolvas√°sa
        const styles = getComputedStyle(document.documentElement);
        const accent = styles.getPropertyValue('--accent-color').trim() || '#1c2c4c';
        const textColor = styles.getPropertyValue('--text-color').trim() || '#003366';
        const red = '#cc0000';
        const principalBorder = accent;
        const principalBg = hexToRGBA(accent, 0.15);
        const interestBorder = red;
        const interestBg = 'rgba(204,0,0,0.15)';
        if (chartInstance) chartInstance.destroy();
        chartInstance = new Chart(ctx, {
          type: "line",
          data: {
            labels,
            datasets: [
              { label: "T≈ëker√©sz", data: capital, borderColor: principalBorder, backgroundColor: principalBg, tension: 0.3 },
              { label: "Kamatr√©sz", data: interest, borderColor: interestBorder, backgroundColor: interestBg, tension: 0.3 }
            ]
          },
          options: {
            maintainAspectRatio:false,
            responsive: true,
            plugins: {
              legend: {
                position: "top",
                labels: {
                  color: textColor
                }
              }
            },
            interaction:{ mode:'index', intersect:false },
            scales: {
              x: {
                ticks: { color: textColor },
                grid: { color: hexToRGBA(accent, 0.2) }
              },
              y: {
                ticks: {
                  color: textColor,
                  callback: value => new Intl.NumberFormat('hu-HU').format(value) + " Ft"
                },
                grid: { color: hexToRGBA(accent, 0.2) }
              }
            }
          }
        });
      }catch(e){
        console && console.warn && console.warn('Chart render hiba:', e);
      }
    }

function renderYear1Chart(p,i){
      try{
        p = Number.isFinite(p) ? Math.max(0, p) : 0;
        i = Number.isFinite(i) ? Math.max(0, i) : 0;
        const total = p + i;
        const noteEl = document.getElementById('firstYearNote');
        const canvas = document.getElementById('year1Chart');
        if(!canvas){ return; }
        const ctx = canvas.getContext && canvas.getContext('2d') ? canvas.getContext('2d') : null;
        if(!ctx || typeof Chart === 'undefined'){
          if(noteEl) noteEl.textContent = 'A diagram jelenleg nem rajzolhat√≥ (hi√°nyz√≥ t√°mogat√°s).';
          return;
        }
        if(total <= 0){
          if(year1Chart){ year1Chart.destroy(); year1Chart = null; }
          if(noteEl) noteEl.textContent = 'Nincs megjelen√≠thet≈ë adat az els≈ë √©vre. Ellen≈ërizd a kezd≈ëd√°tumot √©s a futamid≈ët.';
          return;
        }
        canvas.height = 180;
        // t√©ma szerinti sz√≠nek
        const styles = getComputedStyle(document.documentElement);
        const accent = styles.getPropertyValue('--accent-color').trim() || '#1c2c4c';
        const red = '#cc0000';
        const textColor = styles.getPropertyValue('--text-color').trim() || '#003366';
        if(year1Chart){ year1Chart.destroy(); }
        year1Chart = new Chart(ctx, {
          type:'doughnut',
          data:{ labels:['T≈ëker√©sz (1. √©v)','Kamatr√©sz (1. √©v)'], datasets:[{ data:[p,i], backgroundColor:[hexToRGBA(accent, 0.8), 'rgba(204,0,0,0.8)'] }] },
          options:{ 
            responsive:true, 
            maintainAspectRatio:false, 
            plugins:{ legend:{position:'bottom', labels:{ color: textColor } } } 
          }
        });
        if(noteEl) noteEl.textContent = 'Az els≈ë √©vben a t√∂rleszt√©sek kb. '+(i/total*100).toFixed(0)+'% -a kamat, '+(p/total*100).toFixed(0)+'% -a t≈ëke.';
      }catch(e){
        console && console.warn && console.warn('Year1 chart hiba:', e);
      }
    }

    function calculate() {
      const startDate = safeStartDate();
      const loanAmount = parseHuf(document.getElementById("amount").value);
      const interestRate = (parseFloat(document.getElementById("rate").value)||0) / 100;
      const loanTermYears = parseInt(document.getElementById("term").value);
      const loanTermMonths = loanTermYears * 12;

      if (!(loanAmount>0 && interestRate>0 && loanTermYears>0)) {
        note("K√©rlek, t√∂lts ki minden mez≈ët: √∂sszeg, kamat, futamid≈ë.");
        return;
      }

      const monthlyRate = interestRate / 12;
      const annuity = monthlyRate>0 ? loanAmount * monthlyRate / (1 - Math.pow(1 + monthlyRate, -loanTermMonths)) : loanAmount/loanTermMonths;

      let remainingCapital = loanAmount;
      const formatter = new Intl.NumberFormat("hu-HU");
      amortizationRows = [];

      // √öj CSS oszt√°ly hozz√°ad√°sa a t√°bl√°hoz ('am-table'), hogy s√∂t√©t m√≥dban k√∂nnyebben lehessen form√°zni
      let amortization = "<table class=\"am-table\"><thead><tr><th>H√≥nap</th><th>D√°tum</th><th>T√∂rleszt≈ë</th><th>Kamat</th><th>T≈ëke</th><th>H√°tral√©v≈ë t≈ëke</th></tr></thead><tbody>";

      let currentDate = new Date(startDate.getFullYear(), startDate.getMonth(), 1);
      const today = new Date();
      const monthsPassed = Math.max(0, (today.getFullYear() - startDate.getFullYear()) * 12 + (today.getMonth() - startDate.getMonth()));
      let currentOutstanding = loanAmount;

      // A grafikonhoz haszn√°lt t√∂mb√∂ket glob√°lisan t√°roljuk, hogy √∫jrarenderel√©skor is el√©rhet≈ëek legyenek
      chartLabels = [];
      chartCapital = [];
      chartInterest = [];

      let totalInterest = 0;
      firstYearPrincipal = 0;
      firstYearInterest = 0;
      let switchMonth = null;

      for (let i = 1; i <= loanTermMonths; i++) {
        const interestPortion = remainingCapital * monthlyRate;
        let principalPortion = annuity - interestPortion;
        if(principalPortion < 0) principalPortion = 0;
        if(principalPortion > remainingCapital) principalPortion = remainingCapital;
        remainingCapital -= principalPortion;
        if (remainingCapital < 0) remainingCapital = 0;

        totalInterest += interestPortion;

        const formattedDate = currentDate.toLocaleDateString("hu-HU", { year: 'numeric', month: '2-digit' });

        chartLabels.push(formattedDate);
        chartCapital.push(principalPortion);
        chartInterest.push(interestPortion);

        amortizationRows.push([
          i.toString(),
          formattedDate,
          formatter.format(Math.round(annuity)),
          formatter.format(Math.round(interestPortion)),
          formatter.format(Math.round(principalPortion)),
          formatter.format(Math.max(Math.round(remainingCapital), 0))
        ]);
        amortization += "<tr><td>"+i+"</td><td>"+formattedDate+"</td>" +
  "<td>"+formatter.format(Math.round(annuity))+" Ft</td>" +
  "<td>"+formatter.format(Math.round(interestPortion))+" Ft</td>" +
  "<td>"+formatter.format(Math.round(principalPortion))+" Ft</td>" +
  "<td>"+formatter.format(Math.max(Math.round(remainingCapital), 0))+" Ft</td></tr>";
        currentDate.setMonth(currentDate.getMonth() + 1);
        if (i === monthsPassed) currentOutstanding = Math.max(remainingCapital, 0);

        if(i<=12){ firstYearInterest += interestPortion; firstYearPrincipal += principalPortion; }
        if(switchMonth===null && principalPortion > interestPortion){ switchMonth = i; }

        if(remainingCapital<=0){ break; }
      }

      amortization += "</tbody></table>";
      document.getElementById("amortizationTable").innerHTML = amortization;
      document.getElementById("downloadPDF").style.display = "inline-block";

      // KPI-k
      const paidMonths = chartLabels.length;
      const totalPaid = annuity * paidMonths;
      document.getElementById('kpiPayment').textContent = formatter.format(Math.round(annuity)) + ' Ft';
      document.getElementById('kpiOutstanding').textContent = formatter.format(Math.round(currentOutstanding)) + ' Ft';
      document.getElementById('kpiTotalInterest').textContent = formatter.format(Math.round(totalInterest)) + ' Ft';
      document.getElementById('kpiTotalPaid').textContent = formatter.format(Math.round(totalPaid)) + ' Ft';
      let switchText = '‚Äî';
      if(switchMonth){
        const swDate = new Date(startDate.getFullYear(), startDate.getMonth() + (switchMonth-1), 1);
        const swLabel = swDate.toLocaleDateString('hu-HU', { year:'numeric', month:'long' });
        switchText = swLabel + ' ('+switchMonth+'. h√≥nap)';
      }
      document.getElementById('kpiSwitch').textContent = switchText;
      fitKpiValues();

      renderMainChart(chartLabels, chartCapital, chartInterest);
      renderYear1Chart(firstYearPrincipal, firstYearInterest);
    }

    function fitKpiValues(){
      const els = document.querySelectorAll('#kalkulator .kpi .val');
      els.forEach(el => {
        const maxRem = parseFloat(getComputedStyle(el).getPropertyValue('--kpi-max')) || 1.6;
        const minRem = 0.9;
        el.style.fontSize = (maxRem) + 'rem';
        el.style.whiteSpace = 'nowrap';
        let fs = maxRem;
        let safety = 40;
        while (el.scrollWidth > el.clientWidth && fs > minRem && safety-- > 0){
          fs -= 0.05;
          el.style.fontSize = fs + 'rem';
        }
        if (el.scrollWidth > el.clientWidth){
          el.style.whiteSpace = 'normal';
        } else {
          el.style.whiteSpace = 'nowrap';
        }
      });
    }
    window.addEventListener('resize', () => { clearTimeout(window.__kpiFitT); window.__kpiFitT = setTimeout(fitKpiValues, 100); });

    // --- Lazy load: k√ºls≈ë pdfExport.js-re b√≠zzuk a PDF gener√°l√°st ---
    document.getElementById("downloadPDF").addEventListener("click", () => {
      if (!window.__pdfExportLoaded) {
        const s = document.createElement('script');
        s.src = './pdfExport.js';
        s.onload = () => {
          window.__pdfExportLoaded = true;
          if (typeof window.generatePDF === 'function') {
            window.generatePDF(amortizationRows);
          } else {
            alert("A PDF export modul bet√∂lt≈ëd√∂tt, de a generatePDF() nem tal√°lhat√≥.");
          }
        };
        s.onerror = () => {
          alert("Nem siker√ºlt bet√∂lteni a PDF export modult.");
        };
        document.body.appendChild(s);
      } else {
        window.generatePDF(amortizationRows);
      }
    });

    // Delta kezel≈ëk √©s szcen√°ri√≥k
    const deltaInput = document.getElementById('deltaInput');
    const deltaSlider = document.getElementById('deltaSlider');
    function syncDelta(val){
      const v = Math.max(0, Math.min(10, +val || 0));
      deltaInput.value = v.toFixed(1);
      deltaSlider.value = v.toFixed(1);
    }
    function compareScenarios(){
      const loanAmount = parseHuf(document.getElementById("amount").value);
      const years = parseInt(document.getElementById("term").value);
      const months = years*12;
      const base = parseFloat(document.getElementById('rate').value||'0');
      const d = parseFloat(deltaInput.value||'0');
      if(!(loanAmount>0 && years>0 && base>0)){ return; }
      const aAnnual = Math.max(0.5, Math.min(25, base - d));
      const bAnnual = Math.max(0.5, Math.min(25, base + d));
      const a = aAnnual/100/12;
      const b = bAnnual/100/12;
      const ann = r=> r>0 ? loanAmount*r/(1-Math.pow(1+r,-months)) : loanAmount/months;
      const A = ann(a), B = ann(b);
      const totalA = A*months, totalB=B*months;
      const baseMonthly = (base/100)/12;
      const Base = ann(baseMonthly);
      const totalBase = Base * months;
      document.getElementById('scenarioResults').innerHTML =
        '<div class="kpi" style="grid-template-columns: repeat(3, minmax(0,1fr));">'
        +'<div class="item"><div class="muted">Eredeti kamat ('+base.toFixed(2)+'%)</div><div class="val">'+HUF.format(Math.round(Base))+' Ft</div><div class="muted">Teljes visszafizet√©s: '+HUF.format(Math.round(totalBase))+' Ft</div></div>'
        +'<div class="item"><div class="muted">Kedvez≈ëbb kamat ('+aAnnual.toFixed(2)+'%)</div><div class="val">'+HUF.format(Math.round(A))+' Ft</div><div class="muted">Teljes visszafizet√©s: '+HUF.format(Math.round(totalA))+' Ft</div></div>'
        +'<div class="item"><div class="muted">Dr√°g√°bb kamat ('+bAnnual.toFixed(2)+'%)</div><div class="val">'+HUF.format(Math.round(B))+' Ft</div><div class="muted">Teljes visszafizet√©s: '+HUF.format(Math.round(totalB))+' Ft</div></div>'
        +'</div>';
    }
    deltaInput.addEventListener('input', ()=>{ syncDelta(deltaInput.value); compareScenarios(); });
    deltaSlider.addEventListener('input', ()=>{ syncDelta(deltaSlider.value); compareScenarios(); });
    syncDelta(1.0);

    // Esem√©nyek
    document.getElementById('calcBtn').addEventListener('click', calculate);

    // Dem√≥ alap√©rt√©kek √©s AUTO-SZ√ÅMOL√ÅS bet√∂lt√©skor
    (function demo(){
      const now = new Date();
      const yyyy = now.getFullYear();
      const mm = String(now.getMonth()+1).padStart(2,'0');
      const dd = '01';
      document.getElementById('startDate').value = yyyy+'-'+mm+'-'+dd;
      document.getElementById('amount').value = HUF.format(10000000);
      document.getElementById('rate').value = '6.00'; syncRate(6);
      document.getElementById('term').value = 20;
      setTimeout(()=>{ calculate(); fitKpiValues(); compareScenarios(); }, 0);
    })();

    // A t√©mav√°lt√≥ (s√∂t√©t/vil√°gos m√≥d) esem√©nykezel√©se: friss√≠tj√ºk a diagramok sz√≠neit √©s √∫jrarajzoljuk ≈ëket
    document.addEventListener('DOMContentLoaded', () => {
      // Bet√∂lt√©s ut√°n √°ll√≠tsuk be a Chart.js alap√©rtelmezett sz√≠neit a jelenlegi t√©ma szerint
      updateChartColors();
      const themeBtn = document.getElementById('themeToggle');
      if (themeBtn) {
        themeBtn.addEventListener('click', () => {
          // Kis k√©sleltet√©s, hogy a body s√∂t√©t m√≥d oszt√°ly friss√ºlj√∂n
          setTimeout(() => {
            updateChartColors();
            // ha m√°r vannak kisz√°molt adatok, √∫jra renderelj√ºk a grafikonokat az √∫j sz√≠nek szerint
            if (chartLabels && chartLabels.length) {
              renderMainChart(chartLabels, chartCapital, chartInterest);
            }
            if (typeof firstYearPrincipal !== 'undefined' && typeof firstYearInterest !== 'undefined') {
              renderYear1Chart(firstYearPrincipal, firstYearInterest);
            }
          }, 50);
        });
      }
    });

  })();
  </script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js"></script>
<script defer="" src="./scripts.js"></script>
<script defer="" src="./cookies.js"></script>
<button aria-label="S√∂t√©t m√≥d v√°lt√°sa" class="theme-toggle" id="themeToggle">üåô</button>
</body>
</html>
